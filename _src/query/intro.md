---
id: intro
title: Querying Glean
sidebar_label: Overview
---

import {OssOnly, FbInternalOnly} from 'internaldocs-fb-helpers';
import Daiquery from './fb/daiquery.md';
import {SrcFile,SrcFileLink} from '@site/utils';

Glean's query language is called **Angle**.  Read the [Angle
Guide](../angle/guide.md) to learn about how to write Angle queries.

The [shell](../shell.md) can be used for testing queries and schema
changes, and exploring the data.

<FbInternalOnly>

The `glean` cli is installed by default in most Devservers and Ondemand flavours. To install it manually:

```lang=shell
sudo feature install glean_tools
```

To try queries interactively run the REPL with:

```lang=shell
glean shell
```

or build it from source

```lang=shell
buck run //glean/tools/gleancli:glean -- shell
```

To make a single query:

```lang=shell
glean shell <query>
```

</FbInternalOnly>

<Daiquery />

## Query APIs

<FbInternalOnly>

There are APIs in [Hack](api/fb/hack.md), [Python](api/fb/python.md),
[Rust](api/fb/rust.md), and [Haskell](api/haskell.md).

</FbInternalOnly>

<OssOnly>

There is currently only a [Haskell](api/haskell.md) API; APIs in other
languages are coming soon.

</OssOnly>

All client layers are wrappers around the [Thrift API](#thrift).

The results of queries will be returned as instances of the Thrift
types in `glean/schema/thrift` that are generated automatically from
the [schema](../schema/basic.md).

The client layers provide a few useful things over the raw Thrift API:
* Connecting to the most recent database for a given repository;
* Sharding to ensure we connect to a suitable server for that database;
* In some cases, an API for building queries programmatically.

### Thrift

Glean exposes a <SrcFileLink file="glean/if/glean.thrift">Thrift
API</SrcFileLink>.

The two methods for querying are

* `userQuery` - general queries returning an arbitrary number of results
* `userQueryFacts` - fetch the definition of a single fact given its ID

Queries are in Angle syntax, and results are encoded as JSON or Thrift
compact which you can encode/decode into the Thrift types.


## VS Code syntax highlighter

<FbInternalOnly>

We have a VS Code plugin for Angle syntax highlighting in VS Code: [Glean development Support](https://www.internalfb.com/fb-vscode/marketplace/extension/nuclide.fb-glean/overview?leftNavTab=manage) the code lives [here](https://www.internalfb.com/code/fbsource/[master]/xplat/vscode/vscode-extensions/fb-glean/)

</FbInternalOnly>

<OssOnly>

A VS Code plugin for Angle syntax highlighting is available in this repository, under
`glean/vscode/`. It can either be built from source and installed, or one can download and
install the .vsix file generated by our CI system.

### Building from source

Assuming you have Node JS installed on your system, run the following commands:

```lang=shell
cd glean/vscode
npx vsce package
```

The `npx` command should produce a `glean-x.y.z.vsix` file in the `glean/vscode/` directory,
that you can install in VS Code by following the instructions of the *Installing* section below.

### Downloading from CI

Simply visit [this CI page](https://github.com/facebookincubator/Glean/actions/workflows/ci.yml),
click on the latest successful CI run, scroll down to the *Artifacts* section and click on
`glean-vsix`. This should give you a `.zip` archive that contains a `glean-x.y.z.vsix` file
that you can install in VS Code by following the instructions in the next section.

### Installing

```lang=shell
code --install-extension path/to/glean-x.y.z.vsix
```

[The VS Code documentation](https://code.visualstudio.com/docs/editor/extension-marketplace#_install-from-a-vsix)
describes alternative ways to install an extension from a `.vsix` file, from within the editor,
in case the above command does not work or a more graphical, user-friendly is preferable.

</OssOnly>
